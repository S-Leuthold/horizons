% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/library-uq.R
\name{predict_quantiles}
\alias{predict_quantiles}
\title{Library Prediction Uncertainty Quantification Utilities}
\usage{
predict_quantiles(workflow, new_data, quantiles = c(0.05, 0.95))
}
\arguments{
\item{workflow}{A fitted \code{workflow} object containing a ranger model trained
with \code{quantreg = TRUE}. The workflow must have been created using
\code{\link[=define_quantile_specification]{define_quantile_specification()}}.}

\item{new_data}{A data frame or tibble containing new samples to predict.
Must have the same predictor columns as the training data.}

\item{quantiles}{Numeric vector of quantiles to extract, with values in (0, 1).
Default: \code{c(0.05, 0.95)} for 90\% prediction intervals.}
}
\value{
A tibble with one row per sample in \code{new_data} and columns:
\itemize{
\item \code{.pred_lower}: Lower quantile (typically q05)
\item \code{.pred_upper}: Upper quantile (typically q95)
\item Additional columns for other quantiles if requested
}
}
\description{
Functions for uncertainty quantification in library-based prediction mode.
Provides quantile prediction wrappers, conformal calibration, and interval
construction for the decoupled UQ architecture.

Extracts quantile predictions from a fitted ranger quantile regression model.
This is a wrapper around ranger's quantile prediction that works with
tidymodels workflow objects and returns results in tidy format.
}
\details{
\subsection{How It Works}{

Ranger's quantile regression trains a single random forest that stores
terminal node information from all trees. At prediction time, you can extract
ANY quantile from this single model by specifying which quantiles to compute.

This function:
\enumerate{
\item Extracts the fitted ranger model from the workflow
\item Calls \code{predict.ranger()} with \code{type = "quantiles"}
\item Converts the matrix output to a tidy tibble
}
}

\subsection{Quantile Column Naming}{
\itemize{
\item If \code{quantiles = c(0.05, 0.95)}: returns \code{.pred_lower}, \code{.pred_upper}
\item If \code{quantiles = c(0.10, 0.50, 0.90)}: returns \code{.pred_q10}, \code{.pred_q50}, \code{.pred_q90}
\item General pattern: \verb{.pred_q\{percentile\}} (e.g., \code{.pred_q05}, \code{.pred_q95})
}
}

\subsection{Requirements}{

The workflow must contain a ranger model trained with:
\itemize{
\item \code{quantreg = TRUE} (enables quantile regression)
\item \code{keep.inbag = TRUE} (required for quantile prediction)
}
}
}
\examples{
\dontrun{
# Train quantile model
spec <- define_quantile_specification()
spec$args$mtry <- 10
spec$args$min_n <- 5

wf <- workflow() \%>\%
  add_model(spec) \%>\%
  add_recipe(my_recipe) \%>\%
  fit(data = training_data)

# Predict quantiles
quantiles <- predict_quantiles(wf, new_data = test_data)

# Result has .pred_lower and .pred_upper
head(quantiles)
}

}
\seealso{
\code{\link[=define_quantile_specification]{define_quantile_specification()}},
\code{\link[ranger:predict.ranger]{ranger::predict.ranger()}} for underlying quantile prediction
}
\keyword{Model}
\keyword{Predict}
\keyword{Quantile}
\keyword{Quantiles}
\keyword{Ranger}
\keyword{from}
\keyword{internal}
