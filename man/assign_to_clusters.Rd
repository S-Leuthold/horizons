% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/library-clustering.R
\name{assign_to_clusters}
\alias{assign_to_clusters}
\title{Assign Unknown Samples to Library Clusters}
\usage{
assign_to_clusters(unknown_pca_scores, gmm_model, verbose = TRUE)
}
\arguments{
\item{unknown_pca_scores}{Matrix of PCA scores for unknowns (n × n_components)}

\item{gmm_model}{GMM model object from fit_gmm_clustering()}

\item{verbose}{Logical. Print progress? Default: TRUE}
}
\value{
Tibble with:
\describe{
\item{sample_id}{Row index from unknown_pca_scores}
\item{cluster_id}{Assigned cluster (1 to n_clusters)}
\item{probability}{Assignment probability (0-1), higher = more confident}
\item{entropy}{Shannon entropy of cluster probabilities (0 to log(K))}
\item{flag}{Character: "high_confidence", "low_confidence", "ambiguous"}
}

Returns NULL if assignment fails.
}
\description{
Assigns new (unknown) samples to library clusters using the trained GMM model.
Returns cluster assignments with probability scores and entropy measures for
uncertainty quantification.
}
\details{
Uses \code{predict.Mclust()} to compute:
\itemize{
\item Cluster assignment (highest probability)
\item Assignment probability (confidence in assignment)
\item Shannon entropy (overall uncertainty across all clusters)
}

\strong{Entropy Calculation:}
H = -Σ(p_k * log(p_k)) where p_k is probability for cluster k
\itemize{
\item H = 0: Certain assignment (probability = 1 for one cluster)
\item H = log(K): Maximum uncertainty (equal probability across K clusters)
}

Low-confidence assignments (probability < 0.7 or high entropy) should have
inflated prediction intervals in the UQ layer.
}
\examples{
\dontrun{
# After fitting GMM
assignments <- horizons:::assign_to_clusters(
  unknown_pca_scores = unknown_pca,
  gmm_model = gmm_result$model
)
}

}
\seealso{
\code{\link[=fit_gmm_clustering]{fit_gmm_clustering()}}
}
\keyword{internal}
