% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/library-targets.R
\name{ilr_to_texture}
\alias{ilr_to_texture}
\title{Transform ILR Coordinates Back to Texture}
\usage{
ilr_to_texture(ilr_1, ilr_2, as_gkg = TRUE)
}
\arguments{
\item{ilr_1}{Numeric vector. First ILR coordinate.}

\item{ilr_2}{Numeric vector. Second ILR coordinate.}

\item{as_gkg}{Logical. If TRUE (default), returns g/kg (values sum to 1000).
If FALSE, returns proportions (values sum to 1.0).}
}
\value{
Tibble with three columns (sand, silt, clay). Each row sums to
exactly 1000 (if as_gkg = TRUE) or 1.0 (if as_gkg = FALSE).
}
\description{
Converts two ILR (Isometric Log-Ratio) coordinates back to three-part texture
composition (sand, silt, clay). Inverse of \code{texture_to_ilr()}.
}
\details{
This back-transformation is the key to ensuring compositional predictions:
\enumerate{
\item Models predict ilr_1 and ilr_2 (unbounded coordinates)
\item This function transforms predictions back to texture space
\item Result is GUARANTEED to sum to 100\% (or 1.0 for proportions)
\item All components are guaranteed to be non-negative
}

The transformation preserves the compositional structure and ensures physically
valid predictions even if ILR coordinate predictions are extreme.
}
\section{Guarantees}{

\itemize{
\item \strong{Mass balance}: sand + silt + clay = 1000 (or 1.0) for all samples
\item \strong{Non-negativity}: All components â‰¥ 0
\item \strong{Invertibility}: texture_to_ilr(ilr_to_texture(x)) = x
}
}

\examples{
\dontrun{
# Back-transform ILR predictions to g/kg
texture <- ilr_to_texture(
  ilr_1 = c(0.15, -0.22, 0.08),
  ilr_2 = c(0.33, 0.41, -0.12)
)

# Verify mass balance
sum(texture[1, ])  # Should be exactly 1000

# Get proportions instead
texture_prop <- ilr_to_texture(
  ilr_1 = c(0.15, -0.22),
  ilr_2 = c(0.33, 0.41),
  as_gkg = FALSE
)
}

}
\keyword{internal}
