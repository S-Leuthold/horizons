% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covariates-climate.R
\name{fetch_climate_covariates}
\alias{fetch_climate_covariates}
\title{Retrieve and Summarize Climate Covariates from Daymet}
\usage{
fetch_climate_covariates(
  input_data,
  start_year = 2003,
  end_year = 2024,
  gdd_base = 10,
  cache_dir = tools::R_user_dir("horizons", "cache"),
  refresh = FALSE
)
}
\arguments{
\item{input_data}{A \code{data.frame} or \code{tibble} with numeric \code{Longitude} and \code{Latitude} columns (in decimal degrees).
Other columns (e.g., \code{Sample_ID}, \code{Layer_ID}) are preserved and joined to the output.}

\item{start_year}{Integer. First year of daily climate data to download (inclusive). Defaults to \code{2003}.}

\item{end_year}{Integer. Final year of daily climate data to download (inclusive). Defaults to \code{2024}.}

\item{gdd_base}{Numeric. Base temperature (°C) used to compute growing degree days (GDD). Defaults to \code{10}.}

\item{cache_dir}{File path. Directory where Daymet data will be cached as \code{.qs} files.
Defaults to \code{tools::R_user_dir("horizons", "cache")}.}

\item{refresh}{Logical. If TRUE, forces re-download of data even if cached. Defaults to FALSE.}
}
\value{
A \code{tibble} with one row per input sample, containing the original columns plus six additional climate covariates:
\itemize{
\item \strong{MAT}: Mean annual temperature (°C)
\item \strong{MAP}: Mean annual precipitation (mm)
\item \strong{PET}: Mean annual potential evapotranspiration (mm), estimated using the Hargreaves method
\item \strong{AI}: Aridity Index (MAP / PET)
\item \strong{GDD}: Mean annual Growing Degree Days (base defined by \code{gdd_base})
\item \strong{Precip_Seasonality}: Coefficient of variation (CV\%) of monthly precipitation totals
}
}
\description{
Fetches daily gridded climate data from the Daymet API for a set of geographic coordinates,
then computes key annual covariates including temperature, precipitation, PET (Hargreaves),
aridity index, growing degree days, and precipitation seasonality. Samples are grouped by
Daymet's 4-km grid resolution to minimize redundant downloads. The function is fault-tolerant
and provides progress updates and warnings via the \code{cli} package.
}
\details{
To reduce redundant API calls, samples are aggregated to the nearest Daymet 4-km grid cell using
rounded coordinate matching. Climate data is then downloaded once per grid cell and summarized
annually over the specified date range. PET is calculated daily using the Hargreaves method.
Precipitation seasonality is quantified as the coefficient of variation in monthly means.

Progress is displayed using \code{cli::cli_progress_step()} and warnings are surfaced with
\code{cli_alert_warning()}. Failures during download or summarization do not halt execution
but may result in missing covariates for affected locations.
}
\examples{
\dontrun{
fetch_climate_covariates(
  input_data = my_soil_data,
  start_year = 2010,
  end_year = 2020,
  gdd_base = 5
)
}

}
