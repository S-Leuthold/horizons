% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covariates-soil-download_ossl.R
\name{download_ossl_data}
\alias{download_ossl_data}
\title{Download and Preprocess OSSL MIR and Covariate Data}
\usage{
download_ossl_data(covariates, window_size = 9, max_samples = NULL)
}
\arguments{
\item{covariates}{Character vector of covariate names to retrieve (e.g., \code{"Sand"}, \code{"pH"}, \code{"SOC"}).}

\item{window_size}{Integer. Width of the Savitzky-Golay smoothing window for spectral preprocessing (default = 9).}

\item{max_samples}{Optional. Integer. Maximum number of samples to process from OSSL for testing/debugging. If NULL, all samples are processed.}

\item{bounding_box}{Optional. A bounding box for spatial subsetting (not currently implemented).}
}
\value{
A tibble containing:
\itemize{
\item{Preprocessed MIR spectra (SNV-SG0, 2 cm⁻¹ interval, 600–4000 cm⁻¹)}
\item{Covariate measurements for each sample}
}
}
\description{
Retrieves topsoil mid-infrared (MIR) spectral data and associated covariate measurements
from the Open Soil Spectroscopy Library (OSSL). Applies smoothing and standard normal variate (SNV)
preprocessing to spectra, joins soil covariate information, and caches the final processed dataset.
}
\details{
If cached processed MIR spectra are found, they will be loaded automatically
to avoid reprocessing.

The function workflow includes:
\enumerate{
\item{Reading the OSSL variable dictionary for analyte selection.}
\item{Downloading topsoil metadata and filtering for U.S. sites (optional spatial subsetting to come).}
\item{Downloading laboratory measurements and reshaping to analyte-wide format.}
\item{Loading raw OSSL MIR spectra, smoothing with Savitzky-Golay, applying SNV.}
\item{Caching processed datasets locally for faster reuse.}
}

Cached processed spectra are reused automatically when available.
}
\examples{
\dontrun{
# Example: Download and preprocess OSSL data for Sand and pH
ossl_data <- download_ossl_data(covariates = c("Sand", "pH"))

glimpse(ossl_data)
}

}
\seealso{
\code{\link{predict_covariates}}, \code{\link{create_input_data}}
}
\keyword{internal}
