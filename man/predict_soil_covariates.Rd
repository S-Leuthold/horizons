% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covariates-soil.R
\name{predict_soil_covariates}
\alias{predict_soil_covariates}
\title{Soil Covariate Prediction from MIR Spectra}
\usage{
predict_soil_covariates(
  input_data,
  covariates,
  n_similar = 20000,
  prop = 0.85,
  variance_threshold = 0.985,
  bayesian_iter = 10,
  allow_par = FALSE,
  n_workers = NULL,
  refresh = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{input_data}{Tibble with MIR spectral data and Sample_ID column}

\item{covariates}{Character vector of soil properties to predict}

\item{n_similar}{Integer. Total OSSL samples to select via Kennard-Stone (default: 20000)}

\item{prop}{Numeric. Proportion for training set (default: 0.85)}

\item{variance_threshold}{Numeric. Proportion of variance to capture with PCA (default: 0.85)}

\item{bayesian_iter}{Integer. Bayesian optimization iterations (default: 3, use 0 for grid search only)}

\item{allow_par}{Logical. Enable parallel processing for hyperparameter tuning (default: FALSE, set TRUE for faster execution)}

\item{n_workers}{Integer. Number of parallel workers (default: NULL, auto-detect)}

\item{refresh}{Logical. Force refresh of OSSL training data (default: FALSE)}

\item{verbose}{Logical. Print progress messages (default: TRUE)}
}
\value{
Named list with:
\itemize{
\item predictions: Tibble with Sample_ID and predicted covariate columns
\item validation_metrics: Tibble with accuracy metrics per sample/covariate
\item global_models: List of fitted models for each covariate
\item selection_info: Information about training set selection
}
}
\description{
Predicts soil properties from mid-infrared (MIR) spectroscopy using a Mahalanobis
distance-based local modeling approach with OSSL training data.

Predicts soil covariate values from MIR spectra using OSSL training data and
Cubist models. By default, uses ALL available OSSL samples (~36,000) for best
performance. Simpler selection methods outperform complex algorithms like
Kennard-Stone when sufficient training data is used.
}
\examples{
\dontrun{
# Default: Use 20,000 OSSL samples with clustered Kennard-Stone
results <- predict_soil_covariates(
  input_data = my_mir_spectra,
  covariates = c("clay", "ph", "oc"),
  allow_par = TRUE  # Enable parallel for faster execution
)

# Maximum performance: Use more samples
results <- predict_soil_covariates(
  input_data = my_mir_spectra,
  covariates = "clay",
  n_similar = 30000,
  allow_par = TRUE  # Enable parallel
)

# Faster with fewer samples and no Bayesian optimization
results <- predict_soil_covariates(
  input_data = my_mir_spectra,
  covariates = c("clay", "sand"),
  n_similar = 10000,
  bayesian_iter = 0,  # Skip Bayesian for speed
  allow_par = TRUE
)
}

}
\keyword{Covariates}
\keyword{MIR}
\keyword{Predict}
\keyword{Soil}
\keyword{Spectra}
\keyword{from}
\keyword{internal}
