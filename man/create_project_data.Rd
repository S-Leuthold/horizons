% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/inputs-create_project_data.R
\name{create_project_data}
\alias{create_project_data}
\title{Create Unified Input Data for Spectral Modeling}
\usage{
create_project_data(
  projects,
  variables = character(),
  save_spectra = FALSE,
  save_locale = NULL,
  drop_na = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{projects}{A named list of project entries, typically created using
\code{\link{project_list}}, where each element contains:
\itemize{
\item \code{spectra_path}: folder containing OPUS \code{.0} files
\item \code{sample_obs}: path to CSV file with sample-level data
\item \code{file_name_format}: string defining the filename parsing template
\item \code{file_name_delimiter}: character delimiter in filenames
\item \code{default_fraction}: fallback for samples lacking parsed fraction info
}}

\item{variables}{Character vector of sample observation variables (e.g., \code{"Sand"}, \code{"pH"}) to join.}

\item{save_spectra}{Logical. If \code{TRUE}, saves the full wide-format tibble as an \code{.rds} file.}

\item{save_locale}{Directory path for saving the \code{.rds} file if \code{save_spectra = TRUE}.}

\item{drop_na}{Logical. If \code{TRUE}, rows missing all requested variables are dropped. Default = \code{TRUE}.}

\item{verbose}{Logical. Whether to print progress messages using \pkg{cli}. Default = \code{TRUE}.}
}
\value{
A tibble in wide format with:
\itemize{
\item One row per unique Project–Sample_ID–Fraction
\item Columns for absorbance at 2 cm⁻¹ intervals from 600 to 4000 cm⁻¹
\item Any matched sample-level observation columns requested via \code{variables}
}
}
\description{
Imports, processes, and merges OPUS spectral files across one or more projects. Applies
standardized resampling (2 cm⁻¹ resolution, 600–4000 cm⁻¹), parses metadata from filenames,
joins cleaned spectra with sample-level observations, and returns a wide-format matrix
ready for MIR model development. Can optionally save the output to disk.
}
\details{
This function is a standardized entry point for spectral model development. Each \code{.0} OPUS file
is read and resampled to a uniform grid. Metadata is parsed from filenames, and absorbance spectra
are reshaped to wide format. Optional sample variables are joined from a CSV defined in each project entry.

Spectra are grouped and averaged when multiple scans exist for the same Sample_ID–Fraction pair.

A warning is issued for projects with no \code{.0} files or if OPUS channels are inconsistent within a project.
Invalid or unreadable files are skipped, but execution continues across other projects.
}
\examples{
\dontrun{
projects <- project_list(
  FFAR = project_entry("data/FFAR/spectra", "data/FFAR/soil.csv"),
  AONR = project_entry("data/AONR/OPUS", "data/AONR/soil.csv", default_fraction = "Clay")
)

spectra_data <- create_project_data(
  projects      = projects,
  variables     = c("Sand", "pH"),
  save_spectra  = TRUE,
  save_locale   = "data/processed"
)
}

}
\seealso{
\code{\link{project_entry}}, \code{\link{project_list}}, \code{\link{read_spectral_data}},
\code{\link{parse_filename_metadata}}

Other input_preparation: 
\code{\link{create_project_configurations}()},
\code{\link{project_entry}()},
\code{\link{project_list}()}
}
\concept{input_preparation}
