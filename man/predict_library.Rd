% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/library-orchestrator.R
\name{predict_library}
\alias{predict_library}
\title{Library-Based Prediction Orchestrator}
\usage{
predict_library(
  spectra,
  property,
  remove_water_bands = TRUE,
  debug_mode = FALSE,
  allow_par = TRUE,
  n_workers = 4,
  verbose = TRUE
)
}
\arguments{
\item{spectra}{Tibble or data frame with unknown MIR spectra.
Required columns:
\itemize{
\item Sample_ID: Character, unique sample identifier
\item Spectral columns: Numeric column names (600, 602, 604, ...)
}}

\item{property}{Character vector. One or more properties from LIBRARY_PROPERTIES.
Texture properties (sand, silt, clay) are automatically expanded to all 3 components.}

\item{verbose}{Logical. Print tree-style progress? Default: TRUE.}
}
\value{
Tibble with predictions in long format (one row per sample-property):
\describe{
\item{Sample_ID}{Sample identifier from input}
\item{property}{Property name (e.g., "clay", "ph")}
\item{pred}{Point prediction}
\item{cluster_id}{GMM cluster assignment}
\item{config_id}{Winning config used for this cluster}
}
}
\description{
Main user-facing API for library-based prediction. Orchestrates the complete
workflow: load OSSL library, cluster unknowns, optimize configs per cluster,
train models, generate predictions with proper target handling.

Training-data-free prediction of standard soil properties using OSSL/KSSL
reference libraries. Automatically clusters unknowns, optimizes model configs,
and generates predictions with proper compositional handling for texture.
}
\section{Texture Properties}{

When any texture property (sand, silt, or clay) is requested, ALL THREE
are automatically predicted together using ILR transformation. This ensures
predictions sum to 100\% (mass balance). A message will inform you of this
expansion.
}

\examples{
\dontrun{
# Single property
ph_pred <- predict_library(unknown_spectra, property = "ph")

# Multiple properties
multi_pred <- predict_library(unknown_spectra, property = c("ph", "oc", "clay"))
# Note: "clay" auto-expands to c("sand", "silt", "clay")

# Texture only
texture_pred <- predict_library(unknown_spectra, property = "sand")
# Returns predictions for sand, silt, AND clay (guaranteed to sum to 1000 g/kg)
}

}
\keyword{Library}
\keyword{Predict}
\keyword{Properties}
\keyword{Reference}
\keyword{Soil}
\keyword{Using}
\keyword{internal}
