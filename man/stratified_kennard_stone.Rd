% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covariates-similarity.R
\name{stratified_kennard_stone}
\alias{stratified_kennard_stone}
\title{Stratified Kennard-Stone Sample Selection}
\usage{
stratified_kennard_stone(
  unknown_clusters,
  unknown_matrix,
  relevant_ossl,
  relevant_matrix,
  n_select,
  verbose = TRUE
)
}
\arguments{
\item{unknown_clusters}{Named list result from cluster_unknown_samples()}

\item{unknown_matrix}{Matrix of unknown PCA scores}

\item{relevant_ossl}{Tibble of pre-filtered OSSL samples}

\item{relevant_matrix}{Matrix of relevant OSSL PCA scores}

\item{n_select}{Integer. Total samples to select}

\item{verbose}{Logical. Print progress messages (default: TRUE)}
}
\value{
Integer vector of indices into relevant_matrix/relevant_ossl
}
\description{
Performs Kennard-Stone selection within each unknown cluster to ensure
representative OSSL sampling across different soil spectral types.
First assigns OSSL samples to nearest unknown cluster, then performs
Kennard-Stone selection within each cluster's OSSL subset.
}
\details{
The function:
\enumerate{
\item Calculates proportional allocation based on unknown cluster sizes
\item Assigns each OSSL sample to its nearest unknown cluster
\item Runs Kennard-Stone within each cluster's OSSL subset
\item Returns combined indices from all clusters
}
}
\keyword{internal}
