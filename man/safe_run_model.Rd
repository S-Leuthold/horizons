% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/evaluation-safely_run_single_evaluation.R
\name{safe_run_model}
\alias{safe_run_model}
\title{Safely Run a Single Model Configuration and Log Results}
\usage{
safe_run_model(
  config_row,
  input_data,
  covariate_data,
  variable,
  row_index,
  output_dir,
  grid_size = 10,
  bayesian_iter = 15,
  cv_folds = 5,
  pruning = TRUE,
  save_output = FALSE
)
}
\arguments{
\item{config_row}{A single-row \code{tibble} containing a model configuration. Must include:
\code{model}, \code{transformation}, \code{preprocessing}, \code{covariates}, and \code{include_covariates}.}

\item{input_data}{A \code{tibble} with preprocessed spectral data. Must include \code{Sample_ID},
\code{Wavenumber}, \code{Absorbance}, and the target response variable.}

\item{covariate_data}{Optional \code{tibble} of predicted covariates (must include \code{Sample_ID}),
required if \code{include_covariates = TRUE}.}

\item{variable}{Character. Name of the outcome variable to predict.}

\item{row_index}{Integer. The row index of the configuration in the batch grid, used for labeling files and logging.}

\item{output_dir}{Character path to a directory for saving model output and error logs.}

\item{grid_size}{Integer. Number of candidates for initial grid tuning (default = 10).}

\item{bayesian_iter}{Integer. Number of iterations for Bayesian tuning (default = 15).}

\item{cv_folds}{Integer. Number of cross-validation folds used in tuning (default = 5).}

\item{pruning}{Logical. Whether to skip poorly performing models based on RRMSE after grid tuning (default = \code{TRUE}).}

\item{save_output}{Logical. Whether to save the full model result to disk as a \code{.qs} file (default = \code{FALSE}).}
}
\value{
A named \code{list} with:
\itemize{
\item \strong{status_summary}: A one-row \code{tibble} containing:
\code{row}, \code{wflow_id}, \code{rrmse}, \code{rmse}, \code{rsq},
\code{status} (\code{"success"}, \code{"pruned"}, or \code{"error"}),
file paths (if saved), and any captured error messages.
\item \strong{saved_path}: File path to the pruned model result (\code{.qs}), or \code{NA} if not saved.
}
}
\description{
Evaluates a single model configuration row using the \code{evaluate_model_config()} function,
with robust error handling, logging, output pruning, and optional result caching.
Designed for internal use within \code{run_model_evaluation()} or other batch modeling workflows.
}
\details{
This function isolates evaluation of a single configuration for safe execution in parallelized batch loops.
On success, model outputs are pruned and optionally saved. If an error occurs, the error object is written to a
JSON file and logged to the console via \code{cli}. Pruned workflows are intended for use in stacking via \code{stacks::add_candidates()}.

It is typically called inside \code{run_model_evaluation()} or a \code{purrr::map()} workflow.
}
\examples{
\dontrun{
result <- safe_run_model(
  config_row     = config[1, ],
  input_data     = spectral_data,
  covariate_data = predicted_covs,
  variable       = "MAOM_C_g_kg",
  row_index      = 1,
  output_dir     = "outputs"
)

result$status_summary
}

}
\seealso{
\code{\link{evaluate_model_config}}, \code{\link{run_model_evaluation}}, \code{\link{prune_model_output}}
}
